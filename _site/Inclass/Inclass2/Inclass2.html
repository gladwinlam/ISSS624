<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ISSS624 - Inclass Exercise 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS624</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">Hands-on Exercises</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex_1.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex02/handson2.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">In-Class Exercise</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../Inclass-ex1/inclass-ex1.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Inclass/Inclass2/Inclass2.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About Me</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">1. Import data</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">2. Data Wrangling</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Inclass Exercise 2</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>In this example, we need the following packages:</p>
<ul>
<li><p><strong><em>sf</em></strong></p></li>
<li><p><strong><em>tidyverse</em></strong></p></li>
<li><p><strong><em>tmap</em></strong></p></li>
<li><p><strong><em>spdep</em></strong></p></li>
<li><p><strong><em>funModeling</em></strong> - for Exploratory data analysis</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, spdep, tmap, tidyverse, funModeling)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will be looking at Nigeria water point information. We will be extracting data from water point data exchange platform and from geo-boundaries. The former provides information on the water point data while the latter provides Local Government Area Boundary data of Nigeria.</p>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">1. Import data</h2>
<p>We will save the water point shapefile into a simple feature data table using st_read().</p>
<p>CRS = 4326 parameter will be used. This corresponds to WGS84 coordinate system. Data will take a while to load as there are 4million rows of data in geo_export file. Once loaded, we filter out water point data related to Nigeria only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>wp <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"geodata"</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">layer =</span> <span class="st">"geo_export"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_coun <span class="sc">==</span> <span class="st">"Nigeria"</span>)  <span class="co">#no need change projection system</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We save the sf data table using write_rds() of readr package in rds data format. We will refer to wp_nga variable from here onward.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(wp, <span class="st">"geodata/wp_nga.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we import the boundary data of Nigeria into a simple feature data table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>nga <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"geodata"</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">layer =</span> <span class="st">"nga_admbnda_adm2_osgof_271122"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">crs =</span> <span class="dv">4326</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `nga_admbnda_adm2_osgof_271122' from data source 
  `/Users/gladwinlam/R Quarto/gladwinlam/ISSS624/Inclass/Inclass2/geodata' 
  using driver `ESRI Shapefile'
Simple feature collection with 774 features and 5 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2.668534 ymin: 4.273007 xmax: 14.67882 ymax: 13.89442
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">2. Data Wrangling</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">read_rds</span>(<span class="st">"geodata/wp_nga.rds"</span>),<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 20 features and 72 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3.597668 ymin: 4.97 xmax: 9.216867 ymax: 7.98
Geodetic CRS:  WGS 84
First 10 features:
   row_id                                       source  lat_deg  lon_deg
1  429068                                        GRID3 7.980000 5.120000
2  222071 Federal Ministry of Water Resources, Nigeria 6.964532 3.597668
3  160612                                     WaterAid 6.486940 7.929720
4  160669                                     WaterAid 6.727570 7.648670
5  160642                                     WaterAid 6.779900 7.664850
6  160628                                     WaterAid 6.955560 7.779170
7  160632                                     WaterAid 7.017780 7.841670
8  642747                   Living Water International 7.325500 8.985000
9  642456                   Living Water International 7.171667 9.110000
10 641347                   Living Water International 7.204867 9.216867
   date_repor   time_repor status_id water_sour water_so_2
1  2018-08-29 00:00:00.000   Unknown       &lt;NA&gt;       &lt;NA&gt;
2  2015-08-16 00:00:00.000       Yes   Borehole       Well
3  2020-12-04 00:00:00.000       Yes   Borehole       Well
4  2020-12-04 00:00:00.000       Yes   Borehole       Well
5  2020-12-04 00:00:00.000       Yes   Borehole       Well
6  2020-12-04 00:00:00.000       Yes   Borehole       Well
7  2020-12-04 00:00:00.000       Yes   Borehole       Well
8  2016-10-03 00:00:00.000       Yes   Borehole       Well
9  2016-10-03 00:00:00.000       Yes   Borehole       Well
10 2015-03-28 00:00:00.000       Yes   Borehole       Well
                   water_te_2     X_water_tec facility_t clean_coun clean_adm1
1                    Tapstand        Tapstand   Improved    Nigeria      Ekiti
2             Mechanized Pump Mechanized Pump   Improved    Nigeria       Ogun
3                   Hand Pump       Hand Pump   Improved    Nigeria     Ebonyi
4                        &lt;NA&gt;            &lt;NA&gt;   Improved    Nigeria      Enugu
5                   Hand Pump       Hand Pump   Improved    Nigeria      Enugu
6                   Hand Pump       Hand Pump   Improved    Nigeria      Benue
7                   Hand Pump       Hand Pump   Improved    Nigeria      Benue
8             Mechanized Pump Mechanized Pump   Improved    Nigeria      Benue
9  Hand Pump - India Mark III       Hand Pump   Improved    Nigeria      Benue
10 Hand Pump - India Mark III       Hand Pump   Improved    Nigeria      Benue
      clean_adm2 clean_adm3 clean_adm4 install_ye installer rehab_year
1           Moba       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
2  Obafemi-Owode       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
3        Ohaukwu       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
4        Isi-Uzo       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
5        Isi-Uzo       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
6        Okpokwu       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
7        Okpokwu       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
8          Gboko       &lt;NA&gt;       &lt;NA&gt;       2016      &lt;NA&gt;         NA
9         Bukuru       &lt;NA&gt;       &lt;NA&gt;       2016      &lt;NA&gt;         NA
10        Bukuru       &lt;NA&gt;       &lt;NA&gt;       2015      &lt;NA&gt;         NA
   rehabilita manageme_2 status_cle  pay fecal_coli fecal_co_2
1        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
2        &lt;NA&gt;      Other Functional   No       &lt;NA&gt;       &lt;NA&gt;
3        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
4        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
5        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
6        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
7        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
8        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
9        &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
10       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
           subjective                           activity_i scheme_id
1                &lt;NA&gt; 1a117ba2-5256-4801-874c-f7611a4499dd      &lt;NA&gt;
2  Acceptable quality                                 &lt;NA&gt;      &lt;NA&gt;
3                &lt;NA&gt;                                 &lt;NA&gt;      &lt;NA&gt;
4                &lt;NA&gt;                                 &lt;NA&gt;      &lt;NA&gt;
5                &lt;NA&gt;                                 &lt;NA&gt;      &lt;NA&gt;
6                &lt;NA&gt;                                 &lt;NA&gt;      &lt;NA&gt;
7                &lt;NA&gt;                                 &lt;NA&gt;      &lt;NA&gt;
8                &lt;NA&gt;                 NG160302LWI001005RNM      &lt;NA&gt;
9                &lt;NA&gt;                 NG160115LOI001004RNM      &lt;NA&gt;
10               &lt;NA&gt;                 NG150127LOI001004RNM      &lt;NA&gt;
        wpdx_id     notes
1  6FV7X4JC+222 Tap Water
2  6FR5XH7X+R37     Ajura
3  6FR9FWPH+QVH      &lt;NA&gt;
4  6FR9PJHX+2FF      &lt;NA&gt;
5  6FR9QMH7+XW9      &lt;NA&gt;
6  6FR9XQ4H+6MF      &lt;NA&gt;
7  6FV92R9R+4M7      &lt;NA&gt;
8  6FVC8XGP+622      &lt;NA&gt;
9  6FVF54C6+M26      &lt;NA&gt;
10 6FVF6638+WPX      &lt;NA&gt;
                                                                               orig_lnk
1  https://nigeria.africageoportal.com/datasets/GRID3::grid3-nigeria-water-points/about
2                                                                                  &lt;NA&gt;
3                                                                                  &lt;NA&gt;
4                                                                                  &lt;NA&gt;
5                                                                                  &lt;NA&gt;
6                                                                                  &lt;NA&gt;
7                                                                                  &lt;NA&gt;
8                                                                                  &lt;NA&gt;
9                                                                                  &lt;NA&gt;
10                                                                                 &lt;NA&gt;
   photo_lnk country_id
1       &lt;NA&gt;         NG
2       &lt;NA&gt;         NG
3       &lt;NA&gt;         NG
4       &lt;NA&gt;         NG
5       &lt;NA&gt;         NG
6       &lt;NA&gt;         NG
7       &lt;NA&gt;         NG
8       &lt;NA&gt;         NG
9       &lt;NA&gt;         NG
10      &lt;NA&gt;         NG
                                                                                           data_lnk
1                   https://catalog.waterpointdata.org/datasets/grid3-nigeria-water-points-61ae7cd9
2  https://catalog.waterpointdata.org/datasets/federal-ministry-of-water-resources-nigeria-5efb3667
3                                 https://catalog.waterpointdata.org/datasets/rain-nigeria-5fe0f6d7
4                                 https://catalog.waterpointdata.org/datasets/rain-nigeria-5fe0f6d7
5                                 https://catalog.waterpointdata.org/datasets/rain-nigeria-5fe0f6d7
6                                 https://catalog.waterpointdata.org/datasets/rain-nigeria-5fe0f6d7
7                                 https://catalog.waterpointdata.org/datasets/rain-nigeria-5fe0f6d7
8                                         https://catalog.waterpointdata.org/datasets/test-5f17499e
9                                         https://catalog.waterpointdata.org/datasets/test-5f17499e
10                                        https://catalog.waterpointdata.org/datasets/test-5f17499e
   distance_t  distance_2 distance_3 distance_4 distance_5
1    767.3742   921.79187  3146.7332   41049.94    959.365
2  13364.9005    48.87743  4167.5191   13898.65   9405.783
3   9492.7619  4333.34280   693.2112   27381.92  72060.118
4   9319.0815 23276.33227   307.7162   34823.61  31665.447
5   5437.7141 18783.56566   134.6121   40785.89  31240.904
6  15924.8971  5405.46137  1970.2183   46971.32  44105.500
7  24001.9000  2251.27426  4376.8138   37454.57  45753.406
8   1633.9414   354.17381   175.9985   66655.91  37337.052
9   8213.0330 18316.99175   805.8909   88380.41  19153.497
10 20473.3891 10939.38492   460.3086   94855.63   8470.018
                                                                                                                                                                water_poin
1                                                                              {"2018-08-29": {"source": "GRID3", "status_id": "Unknown", "water_tech_clean": "Tapstand"}}
2  {"2015-08-16": {"source": "Federal Ministry of Water Resources, Nigeria", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Mechanized Pump"}}
3                                            {"2020-12-04": {"source": "WaterAid", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump"}}
4                                                                             {"2020-12-04": {"source": "WaterAid", "status_id": "Yes", "water_source_clean": "Borehole"}}
5                                            {"2020-12-04": {"source": "WaterAid", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump"}}
6                                            {"2020-12-04": {"source": "WaterAid", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump"}}
7                                            {"2020-12-04": {"source": "WaterAid", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump"}}
8                    {"2016-10-03": {"source": "Living Water International", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Mechanized Pump"}}
9         {"2016-10-03": {"source": "Living Water International", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump - India Mark III"}}
10        {"2015-03-28": {"source": "Living Water International", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump - India Mark III"}}
   rehab_prio served_pop local_popu crucialnes pressure usage_cap is_urban
1          NA         NA         NA         NA       NA       250     True
2          NA        140        887  0.1578354 0.140000      1000    False
3          NA          0          0         NA       NA       300    False
4          NA        492        492  1.0000000 1.640000       300    False
5          NA        868       1919  0.4523189 2.893333       300    False
6          NA         81         81  1.0000000 0.270000       300    False
7          NA          0          0         NA       NA       300    False
8          NA       9969      13740  0.7255459 9.969000      1000     True
9          NA        933        933  1.0000000 3.110000       300    False
10         NA       1998      11854  0.1685507 6.660000       300    False
   days_since staleness_ is_latest location_i cluster_si clean_co_2 country_na
1        1483   62.65911         T     358773          1        NGA    Nigeria
2        2592   44.17405         T     264633          1        NGA    Nigeria
3         655   81.34550         T     397972          1        NGA    Nigeria
4         655   81.34550         T     397984          1        NGA    Nigeria
5         655   81.34550         T     397982          1        NGA    Nigeria
6         655   81.34550         T     397976          1        NGA    Nigeria
7         655   81.34550         T     397979          1        NGA    Nigeria
8        2178   50.33174         T     321462          1        NGA    Nigeria
9        2178   50.33174         T     321460          1        NGA    Nigeria
10       2733   42.25373         T     224403          1        NGA    Nigeria
                       water_so_3     water_tech                  status
1                             Tap           &lt;NA&gt;                    &lt;NA&gt;
2  Improved Tube well or borehole      Motorised Functional (and in use)
3   Borehole fitted with Handpump           &lt;NA&gt;                    &lt;NA&gt;
4       Gen. set powered borehole           &lt;NA&gt;                    &lt;NA&gt;
5   Borehole fitted with Handpump           &lt;NA&gt;                    &lt;NA&gt;
6   Borehole fitted with Handpump           &lt;NA&gt;                    &lt;NA&gt;
7   Borehole fitted with Handpump           &lt;NA&gt;                    &lt;NA&gt;
8                        Borehole    Submersible                    &lt;NA&gt;
9                        Borehole India Mark III                    &lt;NA&gt;
10                       Borehole India Mark III                    &lt;NA&gt;
            adm2 adm3 management  adm1 lat_deg_or                   lat_lon_de
1           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;         NA               (7.98?, 5.12?)
2  Obafemi-Owode &lt;NA&gt;      Other  Ogun         NA     (6.9645317?, 3.5976683?)
3           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt; Enugu         NA         (6.48694?, 7.92972?)
4           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt; Enugu         NA         (6.72757?, 7.64867?)
5           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt; Enugu         NA          (6.7799?, 7.66485?)
6           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt; Enugu         NA         (6.95556?, 7.77917?)
7           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt; Enugu         NA         (7.01778?, 7.84167?)
8           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;         NA            (7.3255?, 8.985?)
9           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;         NA        (7.171666667?, 9.11?)
10          &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;         NA (7.204866667?, 9.216866667?)
   lon_deg_or
1          NA
2          NA
3          NA
4          NA
5          NA
6          NA
7          NA
8          NA
9          NA
10         NA
                                                                                               public_dat
1                    https://catalog.waterpointdata.org/datafiles/grid3-nigeria-water-points-61ae7cd9.csv
2  https://catalog.waterpointdata.org/datafiles/federal-ministry-of-water-resources-nigeria-5efb3667.xlsx
3                                 https://catalog.waterpointdata.org/datafiles/rain-nigeria-5fe0f6d7.xlsx
4                                 https://catalog.waterpointdata.org/datafiles/rain-nigeria-5fe0f6d7.xlsx
5                                 https://catalog.waterpointdata.org/datafiles/rain-nigeria-5fe0f6d7.xlsx
6                                 https://catalog.waterpointdata.org/datafiles/rain-nigeria-5fe0f6d7.xlsx
7                                 https://catalog.waterpointdata.org/datafiles/rain-nigeria-5fe0f6d7.xlsx
8                                          https://catalog.waterpointdata.org/datafiles/test-5f17499e.csv
9                                          https://catalog.waterpointdata.org/datafiles/test-5f17499e.csv
10                                         https://catalog.waterpointdata.org/datafiles/test-5f17499e.csv
                                               converted count date_creat
1                                                   &lt;NA&gt;     1 2021-12-06
2  #status_id, #water_source, #pay, #status, #management     1 2020-06-30
3                                                   &lt;NA&gt;     1 2020-12-21
4                                                   &lt;NA&gt;     1 2020-12-21
5                                                   &lt;NA&gt;     1 2020-12-21
6                                                   &lt;NA&gt;     1 2020-12-21
7                                                   &lt;NA&gt;     1 2020-12-21
8                                                   &lt;NA&gt;     1 2020-07-21
9                                                   &lt;NA&gt;     1 2020-07-21
10                                                  &lt;NA&gt;     1 2020-07-21
     time_creat date_updat   time_updat                  geometry
1  21:12:57.000 2021-12-06 21:12:57.000         POINT (5.12 7.98)
2  12:56:07.000 2020-06-30 12:56:07.000 POINT (3.597668 6.964532)
3  19:26:15.000 2020-12-21 19:26:15.000   POINT (7.92972 6.48694)
4  19:26:15.000 2020-12-21 19:26:15.000   POINT (7.64867 6.72757)
5  19:26:15.000 2020-12-21 19:26:15.000    POINT (7.66485 6.7799)
6  19:26:15.000 2020-12-21 19:26:15.000   POINT (7.77917 6.95556)
7  19:26:15.000 2020-12-21 19:26:15.000   POINT (7.84167 7.01778)
8  20:01:34.000 2020-07-21 20:01:34.000      POINT (8.985 7.3255)
9  20:01:34.000 2020-07-21 20:01:34.000     POINT (9.11 7.171667)
10 20:01:34.000 2020-07-21 20:01:34.000 POINT (9.216867 7.204867)</code></pre>
</div>
</div>
<p>From the above, we can see a number of NAs. We will replace NAs in ‘status_cle’ column with “unknown”. ‘status_cle’ shows the water point status and reports whether it is functional or not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>wp_nga <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"geodata/wp_nga.rds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status_cle =</span> <span class="fu">replace_na</span>(status_cle, <span class="st">"Unknown"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can visualise the various statuses of waterpoint using a bar chart with <strong><em>freq()</em></strong> function from funModeling library.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(<span class="at">data=</span>wp_nga, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">input =</span> <span class="st">'status_cle'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Inclass2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        status_cle frequency percentage cumulative_perc
1                       Functional     45883      48.29           48.29
2                   Non-Functional     29385      30.93           79.22
3                          Unknown     10656      11.22           90.44
4      Functional but needs repair      4579       4.82           95.26
5 Non-Functional due to dry season      2403       2.53           97.79
6        Functional but not in use      1686       1.77           99.56
7         Abandoned/Decommissioned       234       0.25           99.81
8                        Abandoned       175       0.18           99.99
9 Non functional due to dry season         7       0.01          100.00</code></pre>
</div>
</div>
<p>As we see, less than half of the water points in Nigeria is functional.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>wp_nga <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"geodata/wp_nga.rds"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status_cle =</span> <span class="fu">replace_na</span>(status_cle, <span class="st">"Unknown"</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>wp_nga</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 95008 features and 72 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 2.707441 ymin: 4.301812 xmax: 14.21828 ymax: 13.86568
Geodetic CRS:  WGS 84
First 10 features:
   row_id                                       source  lat_deg  lon_deg
1  429068                                        GRID3 7.980000 5.120000
2  222071 Federal Ministry of Water Resources, Nigeria 6.964532 3.597668
3  160612                                     WaterAid 6.486940 7.929720
4  160669                                     WaterAid 6.727570 7.648670
5  160642                                     WaterAid 6.779900 7.664850
6  160628                                     WaterAid 6.955560 7.779170
7  160632                                     WaterAid 7.017780 7.841670
8  642747                   Living Water International 7.325500 8.985000
9  642456                   Living Water International 7.171667 9.110000
10 641347                   Living Water International 7.204867 9.216867
   date_repor   time_repor status_id water_sour water_so_2
1  2018-08-29 00:00:00.000   Unknown       &lt;NA&gt;       &lt;NA&gt;
2  2015-08-16 00:00:00.000       Yes   Borehole       Well
3  2020-12-04 00:00:00.000       Yes   Borehole       Well
4  2020-12-04 00:00:00.000       Yes   Borehole       Well
5  2020-12-04 00:00:00.000       Yes   Borehole       Well
6  2020-12-04 00:00:00.000       Yes   Borehole       Well
7  2020-12-04 00:00:00.000       Yes   Borehole       Well
8  2016-10-03 00:00:00.000       Yes   Borehole       Well
9  2016-10-03 00:00:00.000       Yes   Borehole       Well
10 2015-03-28 00:00:00.000       Yes   Borehole       Well
                   water_te_2     X_water_tec facility_t clean_coun clean_adm1
1                    Tapstand        Tapstand   Improved    Nigeria      Ekiti
2             Mechanized Pump Mechanized Pump   Improved    Nigeria       Ogun
3                   Hand Pump       Hand Pump   Improved    Nigeria     Ebonyi
4                        &lt;NA&gt;            &lt;NA&gt;   Improved    Nigeria      Enugu
5                   Hand Pump       Hand Pump   Improved    Nigeria      Enugu
6                   Hand Pump       Hand Pump   Improved    Nigeria      Benue
7                   Hand Pump       Hand Pump   Improved    Nigeria      Benue
8             Mechanized Pump Mechanized Pump   Improved    Nigeria      Benue
9  Hand Pump - India Mark III       Hand Pump   Improved    Nigeria      Benue
10 Hand Pump - India Mark III       Hand Pump   Improved    Nigeria      Benue
      clean_adm2 clean_adm3 clean_adm4 install_ye installer rehab_year
1           Moba       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
2  Obafemi-Owode       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
3        Ohaukwu       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
4        Isi-Uzo       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
5        Isi-Uzo       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
6        Okpokwu       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
7        Okpokwu       &lt;NA&gt;       &lt;NA&gt;         NA      &lt;NA&gt;         NA
8          Gboko       &lt;NA&gt;       &lt;NA&gt;       2016      &lt;NA&gt;         NA
9         Bukuru       &lt;NA&gt;       &lt;NA&gt;       2016      &lt;NA&gt;         NA
10        Bukuru       &lt;NA&gt;       &lt;NA&gt;       2015      &lt;NA&gt;         NA
   rehabilita manageme_2 status_cle  pay fecal_coli fecal_co_2
1        &lt;NA&gt;       &lt;NA&gt;    Unknown &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
2        &lt;NA&gt;      Other Functional   No       &lt;NA&gt;       &lt;NA&gt;
3        &lt;NA&gt;       &lt;NA&gt;    Unknown &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
4        &lt;NA&gt;       &lt;NA&gt;    Unknown &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
5        &lt;NA&gt;       &lt;NA&gt;    Unknown &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
6        &lt;NA&gt;       &lt;NA&gt;    Unknown &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
7        &lt;NA&gt;       &lt;NA&gt;    Unknown &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
8        &lt;NA&gt;       &lt;NA&gt;    Unknown &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
9        &lt;NA&gt;       &lt;NA&gt;    Unknown &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
10       &lt;NA&gt;       &lt;NA&gt;    Unknown &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
           subjective                           activity_i scheme_id
1                &lt;NA&gt; 1a117ba2-5256-4801-874c-f7611a4499dd      &lt;NA&gt;
2  Acceptable quality                                 &lt;NA&gt;      &lt;NA&gt;
3                &lt;NA&gt;                                 &lt;NA&gt;      &lt;NA&gt;
4                &lt;NA&gt;                                 &lt;NA&gt;      &lt;NA&gt;
5                &lt;NA&gt;                                 &lt;NA&gt;      &lt;NA&gt;
6                &lt;NA&gt;                                 &lt;NA&gt;      &lt;NA&gt;
7                &lt;NA&gt;                                 &lt;NA&gt;      &lt;NA&gt;
8                &lt;NA&gt;                 NG160302LWI001005RNM      &lt;NA&gt;
9                &lt;NA&gt;                 NG160115LOI001004RNM      &lt;NA&gt;
10               &lt;NA&gt;                 NG150127LOI001004RNM      &lt;NA&gt;
        wpdx_id     notes
1  6FV7X4JC+222 Tap Water
2  6FR5XH7X+R37     Ajura
3  6FR9FWPH+QVH      &lt;NA&gt;
4  6FR9PJHX+2FF      &lt;NA&gt;
5  6FR9QMH7+XW9      &lt;NA&gt;
6  6FR9XQ4H+6MF      &lt;NA&gt;
7  6FV92R9R+4M7      &lt;NA&gt;
8  6FVC8XGP+622      &lt;NA&gt;
9  6FVF54C6+M26      &lt;NA&gt;
10 6FVF6638+WPX      &lt;NA&gt;
                                                                               orig_lnk
1  https://nigeria.africageoportal.com/datasets/GRID3::grid3-nigeria-water-points/about
2                                                                                  &lt;NA&gt;
3                                                                                  &lt;NA&gt;
4                                                                                  &lt;NA&gt;
5                                                                                  &lt;NA&gt;
6                                                                                  &lt;NA&gt;
7                                                                                  &lt;NA&gt;
8                                                                                  &lt;NA&gt;
9                                                                                  &lt;NA&gt;
10                                                                                 &lt;NA&gt;
   photo_lnk country_id
1       &lt;NA&gt;         NG
2       &lt;NA&gt;         NG
3       &lt;NA&gt;         NG
4       &lt;NA&gt;         NG
5       &lt;NA&gt;         NG
6       &lt;NA&gt;         NG
7       &lt;NA&gt;         NG
8       &lt;NA&gt;         NG
9       &lt;NA&gt;         NG
10      &lt;NA&gt;         NG
                                                                                           data_lnk
1                   https://catalog.waterpointdata.org/datasets/grid3-nigeria-water-points-61ae7cd9
2  https://catalog.waterpointdata.org/datasets/federal-ministry-of-water-resources-nigeria-5efb3667
3                                 https://catalog.waterpointdata.org/datasets/rain-nigeria-5fe0f6d7
4                                 https://catalog.waterpointdata.org/datasets/rain-nigeria-5fe0f6d7
5                                 https://catalog.waterpointdata.org/datasets/rain-nigeria-5fe0f6d7
6                                 https://catalog.waterpointdata.org/datasets/rain-nigeria-5fe0f6d7
7                                 https://catalog.waterpointdata.org/datasets/rain-nigeria-5fe0f6d7
8                                         https://catalog.waterpointdata.org/datasets/test-5f17499e
9                                         https://catalog.waterpointdata.org/datasets/test-5f17499e
10                                        https://catalog.waterpointdata.org/datasets/test-5f17499e
   distance_t  distance_2 distance_3 distance_4 distance_5
1    767.3742   921.79187  3146.7332   41049.94    959.365
2  13364.9005    48.87743  4167.5191   13898.65   9405.783
3   9492.7619  4333.34280   693.2112   27381.92  72060.118
4   9319.0815 23276.33227   307.7162   34823.61  31665.447
5   5437.7141 18783.56566   134.6121   40785.89  31240.904
6  15924.8971  5405.46137  1970.2183   46971.32  44105.500
7  24001.9000  2251.27426  4376.8138   37454.57  45753.406
8   1633.9414   354.17381   175.9985   66655.91  37337.052
9   8213.0330 18316.99175   805.8909   88380.41  19153.497
10 20473.3891 10939.38492   460.3086   94855.63   8470.018
                                                                                                                                                                water_poin
1                                                                              {"2018-08-29": {"source": "GRID3", "status_id": "Unknown", "water_tech_clean": "Tapstand"}}
2  {"2015-08-16": {"source": "Federal Ministry of Water Resources, Nigeria", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Mechanized Pump"}}
3                                            {"2020-12-04": {"source": "WaterAid", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump"}}
4                                                                             {"2020-12-04": {"source": "WaterAid", "status_id": "Yes", "water_source_clean": "Borehole"}}
5                                            {"2020-12-04": {"source": "WaterAid", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump"}}
6                                            {"2020-12-04": {"source": "WaterAid", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump"}}
7                                            {"2020-12-04": {"source": "WaterAid", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump"}}
8                    {"2016-10-03": {"source": "Living Water International", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Mechanized Pump"}}
9         {"2016-10-03": {"source": "Living Water International", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump - India Mark III"}}
10        {"2015-03-28": {"source": "Living Water International", "status_id": "Yes", "water_source_clean": "Borehole", "water_tech_clean": "Hand Pump - India Mark III"}}
   rehab_prio served_pop local_popu crucialnes pressure usage_cap is_urban
1          NA         NA         NA         NA       NA       250     True
2          NA        140        887  0.1578354 0.140000      1000    False
3          NA          0          0         NA       NA       300    False
4          NA        492        492  1.0000000 1.640000       300    False
5          NA        868       1919  0.4523189 2.893333       300    False
6          NA         81         81  1.0000000 0.270000       300    False
7          NA          0          0         NA       NA       300    False
8          NA       9969      13740  0.7255459 9.969000      1000     True
9          NA        933        933  1.0000000 3.110000       300    False
10         NA       1998      11854  0.1685507 6.660000       300    False
   days_since staleness_ is_latest location_i cluster_si clean_co_2 country_na
1        1483   62.65911         T     358773          1        NGA    Nigeria
2        2592   44.17405         T     264633          1        NGA    Nigeria
3         655   81.34550         T     397972          1        NGA    Nigeria
4         655   81.34550         T     397984          1        NGA    Nigeria
5         655   81.34550         T     397982          1        NGA    Nigeria
6         655   81.34550         T     397976          1        NGA    Nigeria
7         655   81.34550         T     397979          1        NGA    Nigeria
8        2178   50.33174         T     321462          1        NGA    Nigeria
9        2178   50.33174         T     321460          1        NGA    Nigeria
10       2733   42.25373         T     224403          1        NGA    Nigeria
                       water_so_3     water_tech                  status
1                             Tap           &lt;NA&gt;                    &lt;NA&gt;
2  Improved Tube well or borehole      Motorised Functional (and in use)
3   Borehole fitted with Handpump           &lt;NA&gt;                    &lt;NA&gt;
4       Gen. set powered borehole           &lt;NA&gt;                    &lt;NA&gt;
5   Borehole fitted with Handpump           &lt;NA&gt;                    &lt;NA&gt;
6   Borehole fitted with Handpump           &lt;NA&gt;                    &lt;NA&gt;
7   Borehole fitted with Handpump           &lt;NA&gt;                    &lt;NA&gt;
8                        Borehole    Submersible                    &lt;NA&gt;
9                        Borehole India Mark III                    &lt;NA&gt;
10                       Borehole India Mark III                    &lt;NA&gt;
            adm2 adm3 management  adm1 lat_deg_or                   lat_lon_de
1           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;         NA               (7.98?, 5.12?)
2  Obafemi-Owode &lt;NA&gt;      Other  Ogun         NA     (6.9645317?, 3.5976683?)
3           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt; Enugu         NA         (6.48694?, 7.92972?)
4           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt; Enugu         NA         (6.72757?, 7.64867?)
5           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt; Enugu         NA          (6.7799?, 7.66485?)
6           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt; Enugu         NA         (6.95556?, 7.77917?)
7           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt; Enugu         NA         (7.01778?, 7.84167?)
8           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;         NA            (7.3255?, 8.985?)
9           &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;         NA        (7.171666667?, 9.11?)
10          &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;         NA (7.204866667?, 9.216866667?)
   lon_deg_or
1          NA
2          NA
3          NA
4          NA
5          NA
6          NA
7          NA
8          NA
9          NA
10         NA
                                                                                               public_dat
1                    https://catalog.waterpointdata.org/datafiles/grid3-nigeria-water-points-61ae7cd9.csv
2  https://catalog.waterpointdata.org/datafiles/federal-ministry-of-water-resources-nigeria-5efb3667.xlsx
3                                 https://catalog.waterpointdata.org/datafiles/rain-nigeria-5fe0f6d7.xlsx
4                                 https://catalog.waterpointdata.org/datafiles/rain-nigeria-5fe0f6d7.xlsx
5                                 https://catalog.waterpointdata.org/datafiles/rain-nigeria-5fe0f6d7.xlsx
6                                 https://catalog.waterpointdata.org/datafiles/rain-nigeria-5fe0f6d7.xlsx
7                                 https://catalog.waterpointdata.org/datafiles/rain-nigeria-5fe0f6d7.xlsx
8                                          https://catalog.waterpointdata.org/datafiles/test-5f17499e.csv
9                                          https://catalog.waterpointdata.org/datafiles/test-5f17499e.csv
10                                         https://catalog.waterpointdata.org/datafiles/test-5f17499e.csv
                                               converted count date_creat
1                                                   &lt;NA&gt;     1 2021-12-06
2  #status_id, #water_source, #pay, #status, #management     1 2020-06-30
3                                                   &lt;NA&gt;     1 2020-12-21
4                                                   &lt;NA&gt;     1 2020-12-21
5                                                   &lt;NA&gt;     1 2020-12-21
6                                                   &lt;NA&gt;     1 2020-12-21
7                                                   &lt;NA&gt;     1 2020-12-21
8                                                   &lt;NA&gt;     1 2020-07-21
9                                                   &lt;NA&gt;     1 2020-07-21
10                                                  &lt;NA&gt;     1 2020-07-21
     time_creat date_updat   time_updat                  geometry
1  21:12:57.000 2021-12-06 21:12:57.000         POINT (5.12 7.98)
2  12:56:07.000 2020-06-30 12:56:07.000 POINT (3.597668 6.964532)
3  19:26:15.000 2020-12-21 19:26:15.000   POINT (7.92972 6.48694)
4  19:26:15.000 2020-12-21 19:26:15.000   POINT (7.64867 6.72757)
5  19:26:15.000 2020-12-21 19:26:15.000    POINT (7.66485 6.7799)
6  19:26:15.000 2020-12-21 19:26:15.000   POINT (7.77917 6.95556)
7  19:26:15.000 2020-12-21 19:26:15.000   POINT (7.84167 7.01778)
8  20:01:34.000 2020-07-21 20:01:34.000      POINT (8.985 7.3255)
9  20:01:34.000 2020-07-21 20:01:34.000     POINT (9.11 7.171667)
10 20:01:34.000 2020-07-21 20:01:34.000 POINT (9.216867 7.204867)</code></pre>
</div>
</div>
<p>Next we filter out water points that are functional.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>wpt_functional <span class="ot">&lt;-</span> wp_nga <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_cle <span class="sc">%in%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Functional"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Functional but not in use"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Functional but needs repair"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(<span class="at">data=</span>wpt_functional, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">input =</span> <span class="st">'status_cle'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Inclass2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                   status_cle frequency percentage cumulative_perc
1                  Functional     45883      87.99           87.99
2 Functional but needs repair      4579       8.78           96.77
3   Functional but not in use      1686       3.23          100.00</code></pre>
</div>
</div>
<p>We also filter out non functional water points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>wpt_nonfunctional <span class="ot">&lt;-</span> wp_nga <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_cle <span class="sc">%in%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Abandoned/Decommissioned"</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Abandoned"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Non-Functional"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Non functional due to dry season"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Non-Functional due to dry season"</span>))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(<span class="at">data=</span>wpt_nonfunctional, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">input =</span> <span class="st">'status_cle'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Inclass2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                        status_cle frequency percentage cumulative_perc
1                   Non-Functional     29385      91.25           91.25
2 Non-Functional due to dry season      2403       7.46           98.71
3         Abandoned/Decommissioned       234       0.73           99.44
4                        Abandoned       175       0.54           99.98
5 Non functional due to dry season         7       0.02          100.00</code></pre>
</div>
</div>
<p>We create another data table where status of water point is unknown.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>wpt_unknown <span class="ot">&lt;-</span> wp_nga <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_cle <span class="sc">==</span> <span class="st">"Unknown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lengths</span>(<span class="fu">st_intersects</span>(nga, wp_nga))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]  17  71   0  57  48 233  34 119 152  66  39 135  63 128 348 169 106 186
 [19]  64  93  81  60  38 113  75  19  14 393 175 172  65   8 202 125 179 308
 [37]  62 227 288 156 298 256  14  47  60 180 365 105 324  96  40  69  54  73
 [55]  17  40   6  13  75  54  39   5 211 100 130  25 142  47  36 223 246 112
 [73] 112  67 556  93  26  35  40  33 894 210 316 103 280   0 349  78 265 281
 [91]  99 287 163 126 199 131 160 155 297  72  82 191  60 131 169 241 189 271
[109]  97 776 159 167 120  97  73  98 124 358 228 129   4   2 108 177 133  22
[127] 329  90  35 127 163  97 176   7 118  82  73  72 197  33   4 138  39  74
[145] 203  18  64 165 115  77  54  90 299  95 211 143   8 104  13  40 110  88
[163] 185 136  45 154  80 309  25 260 188 216 146 256  45  60  32  97 159  52
[181]  47 486  33  68 202  90 162 234  36   2   6  65  23  24  19 207  32  34
[199]  28  34 111  76  58  19  22  25  19  51  35  48  42  66 165  72  51  56
[217] 364 314  63  55 345  19  13 190  71  70 153  59 445 443  81  14 433  89
[235] 163 165 265 194 175 194   0 283 110  15 258   2  70  45  42   0  40   0
[253]   2 117 383  67  82 343  96  22   0 114 118 124 196 104  76 126  21 202
[271]  44 192  32   8  33 127  87  36 107  34 209 102 198 133  20  54  82  51
[289]  59 104  28  23  49  56 103  48  61 154 197 137 178  84 155 601 126  83
[307] 293  24  44  42  34  35 131  36  31  64  90  58 206 122  49   1  15 137
[325]  45  21  38  97 185 201  63 240  58  47  66  33 318 107 173  29 139  42
[343] 139  97 132 111 102 153  33 198  23  63  87 118 260 104 113 111  53  35
[361] 106 244  58  89  64  76 155  61 123  39  32  24 143  71  60  44 255 160
[379] 319 153   7 264  35 138 126 148 293 152  95 201 130 187  73  16 208 116
[397] 148 246 123   0 185 206 301 178 286   0 105 300 290 127 448 139 232  68
[415] 113 162 178 118  46 176 158 551 141  95 173 383  77  64  77  45 213  87
[433] 499 227 552  70 148 105  20   3 361  81  58 240 154 143   0  51 128 131
[451] 206 196 102 178 150  87 131   3 271 125  37  42   2 375  92 118 176 100
[469] 184 147  57  37   0 175   1 100   9 251 133 170  17 100 106  92 252  96
[487] 316 145  96 118 114   0 167  56 122 193  12  55  42  20  64 295 206 131
[505] 115  76   0 190  26  86 175   1   1 143  32  95 148  37 100 145 159  83
[523]  46  43 100   0 115  68 444  92  15  34  54  79  33  39  33  68  49  88
[541]  56   1  28  66 182 166  88 173 125 202  63  66 233 239 113 172 304  77
[559] 167 188  34  62  81  46  40 100 116 186 273  48   1  74  99  38 178 275
[577] 357  65  38  87 273 207  74 100  41  75  74  13  59  12 148  23 181  99
[595]  74  37  25 114 135 161 438  13  12  63  11  69  98 111 239 259  51 120
[613]  20  20  39  41  59  66  33 150  33  23  47  44 172  62  83  77  63  44
[631]  31  68  61 181 142  73  17  88  64 335  94 398  11 275 115  72 345  63
[649] 132 100  44 151  91 166 144 304 185 225 396  77  43 161  62 145 109 148
[667] 109 154  12  50 122  52 103  41  83   9 428 157 205 109 251  14  60 413
[685]  33  25  28  31 485  41 277  60  61 189  64 128   3 445 180 187  89  64
[703]  67 224  36 665 111 133 117   5 199 155 169 111  22 105  11  54  53  25
[721]  88  63  42 158  90 124  54  44  74 103 151   6  48  56 229 185  11  80
[739]  25 168  81 102 199 275  30  52   7 175 178 144 243  59 139  82  59 119
[757] 325 339 248 226  26  27  26  13 199   6  42 423 107 389 319 190 129  70</code></pre>
</div>
</div>
<p>We use st_intersects() to find the various status of water point in Nigeria and use length() to measure the count.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>nga_wp <span class="ot">&lt;-</span> nga <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">total wpt</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">lengths</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_intersects</span>(nga, wp_nga))) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">wpt functional</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">lengths</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_intersects</span>(nga, wpt_functional))) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">wpt non-functional</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">lengths</span>(</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_intersects</span>(nga, wpt_nonfunctional))) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">wpt unknown</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">lengths</span>(</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_intersects</span>(nga, wpt_unknown)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lastly, we save the the output in a new data table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>nga_wp <span class="ot">&lt;-</span> nga_wp <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_functional =</span> <span class="st">`</span><span class="at">wpt functional</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">total wpt</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">pct_non-functional</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">wpt non-functional</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">total wpt</span><span class="st">`</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(nga_wp, <span class="st">"geodata/nga_wp.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>nga_wp <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"geodata/nga_wp.rds"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="fu">qtm</span>(nga_wp, <span class="st">"total wpt"</span>) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">'right'</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>wp_functional <span class="ot">&lt;-</span> <span class="fu">qtm</span>(nga_wp, <span class="st">"wpt functional"</span>)<span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">'right'</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>wp_nonfunctional <span class="ot">&lt;-</span> <span class="fu">qtm</span>(nga_wp, <span class="st">"wpt non-functional"</span>)<span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">'right'</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>unknown <span class="ot">&lt;-</span> <span class="fu">qtm</span>(nga_wp, <span class="st">"wpt unknown"</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">'right'</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(total, wp_functional, wp_nonfunctional, unknown, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Inclass2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>